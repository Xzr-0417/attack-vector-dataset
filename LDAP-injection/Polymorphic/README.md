```markdown
# Документация по инструменту генерации запутанных нагрузок

Данный инструмент предназначен для кодирования и обфускации вводимого текста (обычно атакующих нагрузок) с целью повышения скрытности и обхода систем обнаружения. Ниже приведен подробный анализ функциональных модулей:

## Модуль основных функций кодирования

### URL-кодирование
```python
def url_encode(line):
    return urllib.parse.quote(line)
```

**Принцип обфускации**:
- Преобразует специальные символы (например, пробелы, знаки препинания) в соответствующие Unicode-коды
- Использует формат процентного кодирования (%XX), где XX - шестнадцатеричное значение символа
- Например, пробел преобразуется в `%20`, символ новой строки - в `%0A`
- Данный тип кодирования в основном используется для параметров URL при передаче по сети, чтобы предотвратить нарушение формата протокола

### Преобразование регистра символов
```python
def case_convert(line):
    converted = []
    letter_count = 0
    for char in line:
        if char.isalpha():
            letter_count += 1
            converted.append(char.swapcase() if letter_count % 2 == 1 else char)
        else:
            converted.append(char)
    return ''.join(converted)
```

**Принцип обфускации**:
- Последовательно обрабатывает буквенные символы в тексте
- Попеременно изменяет регистр символов в зависимости от их позиции (четная/нечетная)
- Например, "Payload" преобразуется в "PaYlOaD" и подобные формы
- Нарушает визуальное восприятие исходных слов, усложняя их распознавание
- Сохраняет исходный формат неалфавитных символов для обеспечения синтаксической корректности

### Base64-кодирование
```python
def base64_encode(line):
    return base64.b64encode(line.encode()).decode()
```

**Принцип обфускации**:
- Разбивает каждый байт на 6-битные блоки с последующей рекомбинацией
- Использует 64 печатаемых символа (A-Z, a-z, 0-9, +, /) для представления данных
- Добавляет символы равенства (=) для выравнивания длины
- Например, "Hello" кодируется как "SGVsbG8="
- Преобразует исходные данные в текстовый формат для удобства встраивания в различные протоколы

### Unicode-экранирование
```python
def unicode_escape(line):
    escaped = []
    for char in line:
        cp = ord(char)
        if cp <= 0xFFFF:
            escaped.append(f"\\u{cp:04X}")
        else:
            escaped.append(f"\\U{cp:08X}")
    return ''.join(escaped)
```

**Принцип обфускации**:
- Конвертирует каждый символ в соответствующий код Unicode
- Для символов основной многоязыковой плоскости (BMP) использует формат `\uXXXX`
- Для символов вне BMP использует формат `\UXXXXXXXX`
- Например, "A" (U+0041) преобразуется в `\u0041`
- Представляет символы в текстовом формате для кросс-платформенной передачи и хранения

### HTML-кодирование сущностей
```python
def html_encode(line):
    return html.escape(line, quote=True)
```

**Принцип обфускации**:
- Преобразует специальные символы в соответствующие HTML-сущности
- Основные преобразования:
  - `<` → `&lt;`
  - `>` → `&gt;`
  - `&` → `&amp;`
  - `"` → `&quot;`
  - `'` → `&#x27;`
- Гарантирует корректный парсинг текста в HTML-среде
- Например, `<script>` преобразуется в `&lt;script&gt;`

## Модуль списка кодировщиков
```python
ENCODERS = [
    ("url", url_encode),
    ("case", case_convert),
    ("base64", base64_encode),
    ("unicode", unicode_escape),
    ("html", html_encode)
]
```

Данный модуль определяет поддерживаемые типы кодирования и соответствующие им функции обработки, обеспечивая быстрый доступ к нужным методам преобразования по имени.

## Примеры использования

### Режим полного кодирования
```bash
python3 unified_encoder.py input.txt output.txt
```

### Режим выборочного кодирования
```bash
python3 unified_encoder.py input.txt output.txt url
```
