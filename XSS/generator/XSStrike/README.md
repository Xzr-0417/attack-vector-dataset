# Генератор XSS-полезных нагрузок

Данный скрипт-генератор основан на репозитории XSStrike. Он объединяет функционал utils.py, jsContexter.py и config.py в generator.py. В основном разделе имитируются контексты (места появления XSS-тегов, например HTML и атрибуты) и ответ (содержимое HTTP-ответа). Цель — понять механизм генерации полезных нагрузок.

## Обзор

### Основная конфигурация
Скрипт содержит раздел базовой конфигурации, который определяет:
- **Строку проверки XSS**: Уникальная строка (`v3dm0s`) для идентификации успешного выполнения нагрузки.
- **Черный список тегов**: Теги вроде `iframe`, `title` и `textarea`, которые обычно фильтруются системами защиты.
- **Разрешенные теги**: Теги типа `html`, `a` и `details`, которые можно использовать для XSS.
- **Наполнители**: Последовательности символов для обфускации нагрузок и обхода простых фильтров.
- **Обработчики событий**: События вроде `ontoggle`, `onmouseover` и `onpointerenter`, запускающие выполнение JavaScript.
- **JavaScript-функции**: Функции типа `confirm()` и `prompt()` для тестирования уязвимостей XSS.

### Замыкание JavaScript-контекста
Функция `jsContexter` корректно закрывает JavaScript-контексты. Она анализирует контекст перед строкой проверки XSS и генерирует необходимые закрывающие символы для корректного выполнения нагрузки.

### Вспомогательные функции
- **Случайное изменение регистра**: Функция `randomUpper` рандомизирует регистр символов для обхода регистрозависимых фильтров.
- **Извлечение скриптов**: Функция `extractScripts` находит места появления строки проверки в тегах скриптов ответа.

### Логика генерации нагрузок
Функция `generator` — ядро процесса генерации. Она:
- Анализирует контекст появления строки проверки (HTML, атрибут, скрипт).
- Создает нагрузки, адаптированные под каждый контекст.
- Приоритезирует нагрузки по вероятности успеха.

## Особенности

- **Контекстно-зависимые нагрузки**: Генерация нагрузок для разных контекстов:
  - **HTML-контекст**: Нагрузки, выходящие из HTML и внедряющие теги скриптов.
  - **Контекст атрибутов**: Нагрузки, закрывающие атрибуты и внедряющие обработчики событий.
  - **Контекст скриптов**: Нагрузки, выполняющиеся внутри JavaScript-кода.

- **Методы обфускации**:
  - Случайное изменение регистра.
  - URL-кодирование и трансформация символов.
  - Вставка наполнителей и комментариев.

- **Использование обработчиков событий**: Задействует различные события для запуска JavaScript в разных сценариях.

- **Приоритезация нагрузок**: Генерация нагрузок с разным уровнем приоритета в зависимости от вероятности успеха.

## Использование

1. **Клонирование репозитория**:

```bash
git clone https://github.com/Xzr-0417/attack-vector-dataset/tree/main/XSS/generator/XSStrike
cd xss-generator
```

2. **Генерация нагрузок**:

Запустите Python-скрипт:

```bash
python xss_generator.py
```

3. **Просмотр нагрузок**:

Скрипт выведет нагрузки в консоль. Их можно интегрировать в процесс тестирования для выявления XSS-уязвимостей.

4. **Настройка параметров**:

Изменяйте параметры в разделе конфигурации для адаптации под конкретные задачи.

## Пример вывода

Пример сгенерированных нагрузок:

```
Generated XSS Payloads:

▶ Приоритет 10 (всего 24):
  01. </TEXTAREA><html%09ontoggle=%09coFirM()%0D>v3dm0s
  02. </TEXTAREA><html%09ontoggle=%09(confirm)()%0D>v3dm0s
  03. </TEXTAREA><html%09ontoggle=%09a=prompt,a()%0D>v3dm0s
  ...
```

Эти нагрузки можно использовать для проверки уязвимостей в веб-приложениях.

## Важно

Инструмент предназначен исключительно для авторизованного тестирования безопасности и исследований. Всегда получайте разрешение перед тестированием любых систем.
